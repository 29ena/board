<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="article">
	
	<!-- 전체 조회 -->
	<select id = "articleList" resultType="articleVo">
		select *
		from article
		where article_board=#{board_id}
	</select>
	
	<!-- 게시글 페이지 리스트 조회 -->
	<select id="articlePagingList" parameterType="pageVo" resultType="articleVo">
		<![CDATA[
		select *
		from 
		(select a.*, rownum rn
		from
		(select a.*
		from article a
		where article_board = #{board_id}
		order by article_id) a)
		where rn >= (#{page}-1)*#{pageSize} + 1 and rn <= #{page}*#{pageSize}
		
		select b.*
		from
		(select a.*, rownum rn
		from
		(select article.article_id, article.article_pid, lpad(' ㄴ', (level-1)*4) || article.article_title
		from article article
		where article_board = 1
		start with article_pid is null
		--start with seq = 4
		connect by prior article_id = article_pid
		order siblings by group_seq desc, article_id asc)a)b
		where b.rn >=1 and b.rn <= 10;
		]]>
	</select>
	
	<!-- 게시글 전체수 조회 -->
    <select id="articlesCnt" resultType="int">
    	select count(*)
		from article
    </select>
    
    <!-- 게시글 상세보기 -->
    <select id = "getArticle" parameterType = "int" resultType="articleVo">
    	select *
    	from article
    	where article_id = #{article_id}
    </select>
    
    
</mapper>